setwd("stage_gravel/")
Kolpelke_2017_inter <- read.csv2("importation_mangal/Kolpelke_2017/data/Kolpelke_2017_inter.csv", header = TRUE, sep = ";")
taxa_back_df <- read.csv2("importation_mangal/Kolpelke_2017/data/Kolpelke_2017_taxa_back.csv", header = TRUE, sep = ";")
taxa_df <- read.csv2("importation_mangal/Kolpelke_2017/data/Kolpelke_2017_taxa_df.csv", header = TRUE, sep = ";")
enviro_df <- read.csv2("importation_mangal/Kolpelke_2017/data/Kolpelke_2017_enviro_df.csv", header = TRUE, sep = ";")
trait_galler <- read.csv2("importation_mangal/Kolpelke_2017/data/Kolpelke_2017_trait_galler.csv", header = TRUE, sep = ";")
trait_parasit <- read.csv2("importation_mangal/Kolpelke_2017/data/Kolpelke_2017_trait_parasit.csv", header = TRUE, sep = ";")
network_df <- read.csv2("importation_mangal/Kolpelke_2017/data/Kolpelke_2017_network_df.csv", header = TRUE, sep = ";")
View(enviro_df)
enviro_df <- unique(enviro_df)
# writing enviro_df
write.csv2(x = enviro_df, file = "importation_mangal/Kolpelke_2017/data/Kolpelke_2017_enviro_df.csv", row.names = FALSE)
View(trait_galler)
i = 1
network_temp  <- subset(network_df, network_df$number == 1)[1, ]
enviro_temps  <- subset(enviro_df, enviro_df$number == 1)[1, ]
View(network_df)
View(network_temp)
network_temp  <- subset(network_df, network_df$number == 1)
enviro_temps  <- subset(enviro_df, enviro_df$number == 1)
View(enviro_temps)
?tolower
A <- "AAAAA"
chartr(A, lower)
tolower(A)
rearing_number <- as.vector(network_temp$REARING_NUMBER)
rearing_number
inter_temp <- subset(Kolpelke_2017_inter, Kolpelke_2017_inter$REARING_NUMBER == rearing_number)
inter_temp <- subset(Kolpelke_2017_inter, Kolpelke_2017_inter$REARING_NUMBER %in% rearing_number)
View(inter_temp)
taxon_temp <- subset(taxa_df, taxa_df$REARING_NUMBER %in% rearing_number)
View(taxon_temp)
View(trait_galler)
t_galler_temp <- subset(trait_galler, trait_galler$REARING_NUMBER %in% rearing_number)
t_parasit_temp <- subset(trait_galler, trait_galler$REARING_NUMBER %in% rearing_number)
View(t_parasit_temp)
?unique
subset(t_galler_temp, !duplicated(taxon))
t_galler_temp  <- subset(subset(trait_galler, trait_galler$REARING_NUMBER %in% rearing_number), duplicated(taxon))
t_parasit_temp <- subset(subset(trait_galler, trait_galler$REARING_NUMBER %in% rearing_number), !duplicated(taxon))
t_parasit_temp
View(t_galler_temp)
t_galler_temp  <- subset(subset(trait_galler, trait_galler$REARING_NUMBER %in% rearing_number), duplicated(taxon))
t_parasit_temp <- subset(subset(trait_parasit, trait_parasit$REARING_NUMBER %in% rearing_number), !duplicated(taxon))
View(t_parasit_temp)
View(trait_parasit)
unlink("importation_mangal/Kolpelke_2017/reshapeSalix/csv", recursive = TRUE)
unlink("importation_mangal/Kolpelke_2017/reshapeSalix/rdata", recursive = TRUE)
# Open files
df_site    <- readRDS("importation_mangal/Kolpelke_2017/rdata/df_site.rds")
df_salix   <- readRDS("importation_mangal/Kolpelke_2017/rdata/df_salix.rds")
df_galler  <- readRDS("importation_mangal/Kolpelke_2017/rdata/df_galler.rds")
df_parasit <- readRDS("importation_mangal/Kolpelke_2017/rdata/df_parasit.rds")
df_inter   <- readRDS("importation_mangal/Kolpelke_2017/rdata/df_interact.rds")
# Merging site and interaction
site_inter <- merge(df_inter, df_salix, by = "RSAL")
site_inter <- merge(site_inter, df_galler, by = "RGALLER")
site_inter <- merge(site_inter, df_parasit, by = "RPAR")
site_inter <- merge(site_inter, df_site, by = "REARING_NUMBER")
# Isolate interactions
inter_galler <- site_inter[, c(1, 26, 7, 11, 5 )]
names(inter_galler) <- c("REARING_NUMBER", "date", "taxon_sp_1", "taxon_sp_2", "value")
inter_galler["attr"] <- "Number of galls"
inter_galler["salix"] <- "Salix "
inter_galler <- unite(inter_galler, taxon_sp_1, c(salix, taxon_sp_1), sep = "")
inter_para <- site_inter[, c(1, 26, 11, 24, 6)]
names(inter_para) <- c("REARING_NUMBER", "date", "taxon_sp_1", "taxon_sp_2", "value")
# Set libraries
library(reshape2)
library(tidyr)
library(jsonlite)
library(httr)
library(data.table)
library(rcrossref)
library(taxize)
library(stringr)
# Open files
df_site    <- readRDS("importation_mangal/Kolpelke_2017/rdata/df_site.rds")
df_salix   <- readRDS("importation_mangal/Kolpelke_2017/rdata/df_salix.rds")
df_galler  <- readRDS("importation_mangal/Kolpelke_2017/rdata/df_galler.rds")
df_parasit <- readRDS("importation_mangal/Kolpelke_2017/rdata/df_parasit.rds")
df_inter   <- readRDS("importation_mangal/Kolpelke_2017/rdata/df_interact.rds")
# Merging site and interaction
site_inter <- merge(df_inter, df_salix, by = "RSAL")
site_inter <- merge(site_inter, df_galler, by = "RGALLER")
site_inter <- merge(site_inter, df_parasit, by = "RPAR")
site_inter <- merge(site_inter, df_site, by = "REARING_NUMBER")
# Isolate interactions
inter_galler <- site_inter[, c(1, 26, 7, 11, 5 )]
names(inter_galler) <- c("REARING_NUMBER", "date", "taxon_sp_1", "taxon_sp_2", "value")
inter_galler["attr"] <- "Number of galls"
inter_galler["salix"] <- "Salix "
inter_galler <- unite(inter_galler, taxon_sp_1, c(salix, taxon_sp_1), sep = "")
inter_para <- site_inter[, c(1, 26, 11, 24, 6)]
names(inter_para) <- c("REARING_NUMBER", "date", "taxon_sp_1", "taxon_sp_2", "value")
inter_para[, "taxon_sp_2"] <- word(inter_para[, "taxon_sp_2"], start = 1, end = 2)
inter_para["attr"] <- "Number of parasited galls"
Kolpelke_2017_inter <- rbind(inter_galler, inter_para)
rm(inter_galler, inter_para, site_inter)
# Add localistaiton
coord <- subset(df_site, select = c("REARING_NUMBER", "NDECDEG", "EDECDEG"))
names(coord) <- c("REARING_NUMBER", "lat", "lon")
Kolpelke_2017_inter <- merge(Kolpelke_2017_inter, coord, by = "REARING_NUMBER")
Kolpelke_2017_inter <- na.omit(Kolpelke_2017_inter)
rm(coord)
# Add type of interaction
Kolpelke_2017_inter[, "type"] <- "parasitism"
inquiline <- as.vector(t(word(subset(df_parasit, df_parasit$`P/I` == "I" ,select = "FULL_NAME")[, "FULL_NAME"], start = 1, end = 2)))
V <- which(Kolpelke_2017_inter[, "taxon_sp_2"] %in% inquiline)
Kolpelke_2017_inter[V, "type"] <- "commensalism"
rm(inquiline, V)
# isolate parasite trait
trait_parasit <- merge(df_inter[, c(1, 4)], df_parasit[, c(1, 8, 9, 10, 11)], by = "RPAR")
trait_parasit$FULL_NAME <- word(trait_parasit$FULL_NAME, 1, 2)
trait_parasit <- trait_parasit[, -1]
# Replace code by original names
trait_parasit$`ENDO/ECTO`[trait_parasit$`ENDO/ECTO`=="Endo"] <- "Endoparasitism"
trait_parasit$`ENDO/ECTO`[trait_parasit$`ENDO/ECTO`=="Ecto"] <- "Ectoparasitism"
trait_parasit$`KOINO/IDIO`[trait_parasit$`KOINO/IDIO`=="Koino"] <- "Koinobiont"
trait_parasit$`KOINO/IDIO`[trait_parasit$`KOINO/IDIO`=="Idio"] <- "Idiobiont"
trait_parasit$`1INSTAR/LINSTAR/COCOON/EGG`[trait_parasit$`1INSTAR/LINSTAR/COCOON/EGG`=="1INSTAR"] <- "1st instar larvae"
trait_parasit$`1INSTAR/LINSTAR/COCOON/EGG`[trait_parasit$`1INSTAR/LINSTAR/COCOON/EGG`=="LINSTAR"] <- "later instar larvae"
trait_parasit$`1INSTAR/LINSTAR/COCOON/EGG`[trait_parasit$`1INSTAR/LINSTAR/COCOON/EGG`=="COCOON"] <- "cocoons"
trait_parasit$`1INSTAR/LINSTAR/COCOON/EGG`[trait_parasit$`1INSTAR/LINSTAR/COCOON/EGG`=="EGG"] <- "eggs"
trait_parasit$`1INSTAR/LINSTAR/COCOON/EGG`[trait_parasit$`1INSTAR/LINSTAR/COCOON/EGG`=="1INSTAR/COCOON"] <- "1st instar larvae or eggs"
View(trait_parasit)
names(trait_parasit) <- c("REARING_NUMBER", "Endo/Ecto", "Koino/Idio", "stage of the host", "taxon")
trait_parasit <- melt(trait_parasit, id.vars = c("REARING_NUMBER", "taxon"), na.rm = TRUE)
trait_parasit[which(trait_parasit$value==""), 4] <- NA
trait_parasit <- na.omit(trait_parasit)
names(trait_parasit) <- c("REARING_NUMBER", "taxon", "name", "value")
write.csv2(x = trait_parasit, file = "importation_mangal/Kolpelke_2017/data/Kolpelke_2017_trait_parasit.csv", row.names = FALSE)
t_parasit_temp <- subset(subset(trait_parasit, trait_parasit$REARING_NUMBER %in% rearing_number), !duplicated(taxon))
t_parasit_temp <- subset(trait_parasit, trait_parasit$REARING_NUMBER %in% rearing_number)
?duplicated
duplicated(t_parasit_temp, by = c(taxon, name))
duplicated(t_parasit_temp, by = c("taxon", "name"))
View(t_parasit_temp)
!duplicated(t_parasit_temp, by = c("taxon", "name"))
t_parasit_temp[!duplicated(t_parasit_temp[,c("taxon", "name")]),]
t_parasit_temp <- t_parasit_temp[!duplicated(t_parasit_temp[,c("taxon", "name")]),]
network <- list(date             = network_temp[1, 7],
lat              = network_temp[1, 3],
lon              = network_temp[1, 4],
srid             = srid,
description      = network_temp[1, 1],
public           = TRUE,
all_interactions = FALSE)
srid <- 4326
network <- list(date             = network_temp[1, 7],
lat              = network_temp[1, 3],
lon              = network_temp[1, 4],
srid             = srid,
description      = network_temp[1, 1],
public           = TRUE,
all_interactions = FALSE)
View(network)
network <- list(date             = as.character(network_temp[1, 7]),
lat              = network_temp[1, 3],
lon              = network_temp[1, 4],
srid             = srid,
description      = as.character(network_temp[1, 1]),
public           = TRUE,
all_interactions = FALSE)
View(network)
network
# Subset table to select data from i dataset
network_temp <- subset(network_df, network_df$number == 1)
enviro_temp  <- subset(enviro_df, enviro_df$number == 1)
enviro <- list(name  = enviro_temp[1, 6],
lat   = enviro_temp[1, 1],
lon   = enviro_temp[1, 2],
srid  = srid,
date  = enviro_temp[1, 5],
value = enviro_temp[1, 3])
enviro
enviro <- list(name  = enviro_temp[1, 6],
lat   = enviro_temp[1, 1],
lon   = enviro_temp[1, 2],
srid  = srid,
date  = as.character(enviro_temp[1, 5]),
value = enviro_temp[1, 3])
enviro
inter <- list(taxon_1_level = "population",
taxon_2_level = "population",
date          = inter_temp[1, 2],
direction     = "directed",
method        = "Field observation",
description   = "null",
public        = TRUE,
lat           = inter_temp[1, 7],
lon           = inter_temp[1, 8],
srid          = srid)
inter
inter <- list(taxon_1_level = "population",
taxon_2_level = "population",
date          = as.charcter(inter_temp[1, 2]),
direction     = "directed",
method        = "Field observation",
description   = "null",
public        = TRUE,
lat           = inter_temp[1, 7],
lon           = inter_temp[1, 8],
srid          = srid)
inter <- list(taxon_1_level = "population",
taxon_2_level = "population",
date          = as.character(inter_temp[1, 2]),
direction     = "directed",
method        = "Field observation",
description   = "null",
public        = TRUE,
lat           = inter_temp[1, 7],
lon           = inter_temp[1, 8],
srid          = srid)
inter
taxon_temp     <- taxon_temp[!duplicated(taxon_temp[,"original_name"]),]
network_temp <- unique(network_temp)
network_temp <- network_temp[1, ]
taxa_temp     <- subset(taxa_df, taxa_df$REARING_NUMBER %in% rearing_number)
taxa_temp     <- taxon_temp[!duplicated(taxon_temp[,"original_name"]),]
setwd("mangal.package/")
devtools::loadall()
devtool::loadall()
install.packages("devtools")
devtools::load_all()
install.packages("RPostgreSQL")
devtools::load_all()
install.packages("geojsonio")
devtools::load_all()
library(mangal)
version
devtools::find_rtools(T)
version
devtools::find_rtools(T)
devtools::find_rtools()
install.packages(installr)
install.packages("installr")
installr::install.Rtools()
install.packages("knitr")
install.packages("rmarkdown")
install.packages("testthat")
devtools::document()
devtools::document()
library(mangal)
